{
	"name": "Dataverse_Copy_POC_Case",
	"properties": {
		"folder": {
			"name": "Dataverse_POC"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "synapsetestd365-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "source1"
				},
				{
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Dataverse_Pre_Prod_Case",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "join1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Id as string,",
				"          SinkCreatedOn as timestamp,",
				"          SinkModifiedOn as timestamp,",
				"          statecode as long,",
				"          statuscode as long,",
				"          caseorigincode as long,",
				"          casetypecode as long,",
				"          contractservicelevelcode as long,",
				"          customersatisfactioncode as long,",
				"          firstresponseslastatus as long,",
				"          incidentstagecode as long,",
				"          messagetypecode as long,",
				"          prioritycode as long,",
				"          ract_type as long,",
				"          ract_vulnerabilitytypes as long,",
				"          resolvebyslastatus as long,",
				"          servicestage as long,",
				"          severitycode as long,",
				"          activitiescomplete as boolean,",
				"          blockedprofile as boolean,",
				"          checkemail as boolean,",
				"          customercontacted as boolean,",
				"          decremententitlementterm as boolean,",
				"          firstresponsesent as boolean,",
				"          followuptaskcreated as boolean,",
				"          isdecrementing as boolean,",
				"          isescalated as boolean,",
				"          merged as boolean,",
				"          msdyn_copilotengaged as boolean,",
				"          ract_haswrittenresponserequested as boolean,",
				"          ract_isrelatedtoincident as boolean,",
				"          ract_permissionforvulnerabilityrecording as boolean,",
				"          ract_setmanualduedate as boolean,",
				"          ract_supportserviceprovided as boolean,",
				"          routecase as boolean,",
				"          accountid as string,",
				"          accountid_entitytype as string,",
				"          contactid as string,",
				"          contactid_entitytype as string,",
				"          contractdetailid as string,",
				"          contractdetailid_entitytype as string,",
				"          contractid as string,",
				"          contractid_entitytype as string,",
				"          createdby as string,",
				"          createdby_entitytype as string,",
				"          createdbyexternalparty as string,",
				"          createdbyexternalparty_entitytype as string,",
				"          createdonbehalfby as string,",
				"          createdonbehalfby_entitytype as string,",
				"          entitlementid as string,",
				"          entitlementid_entitytype as string,",
				"          existingcase as string,",
				"          existingcase_entitytype as string,",
				"          firstresponsebykpiid as string,",
				"          firstresponsebykpiid_entitytype as string,",
				"          kbarticleid as string,",
				"          kbarticleid_entitytype as string,",
				"          masterid as string,",
				"          masterid_entitytype as string,",
				"          modifiedby as string,",
				"          modifiedby_entitytype as string,",
				"          modifiedbyexternalparty as string,",
				"          modifiedbyexternalparty_entitytype as string,",
				"          modifiedonbehalfby as string,",
				"          modifiedonbehalfby_entitytype as string,",
				"          msdyn_iotalert as string,",
				"          msdyn_iotalert_entitytype as string,",
				"          owningbusinessunit as string,",
				"          owningbusinessunit_entitytype as string,",
				"          owningteam as string,",
				"          owningteam_entitytype as string,",
				"          owninguser as string,",
				"          owninguser_entitytype as string,",
				"          parentcaseid as string,",
				"          parentcaseid_entitytype as string,",
				"          primarycontactid as string,",
				"          primarycontactid_entitytype as string,",
				"          productid as string,",
				"          productid_entitytype as string,",
				"          ract_account as string,",
				"          ract_account_entitytype as string,",
				"          ract_category as string,",
				"          ract_category_entitytype as string,",
				"          ract_complaintdesiredoutcome as string,",
				"          ract_complaintdesiredoutcome_entitytype as string,",
				"          ract_complaintoutcome as string,",
				"          ract_complaintoutcome_entitytype as string,",
				"          ract_complaintreopenedreason as string,",
				"          ract_complaintreopenedreason_entitytype as string,",
				"          ract_complaintsecondaryreason as string,",
				"          ract_complaintsecondaryreason_entitytype as string,",
				"          ract_person as string,",
				"          ract_person_entitytype as string,",
				"          ract_product as string,",
				"          ract_product_entitytype as string,",
				"          ract_representative as string,",
				"          ract_representative_entitytype as string,",
				"          ract_site as string,",
				"          ract_site_entitytype as string,",
				"          ract_subcategory as string,",
				"          ract_subcategory_entitytype as string,",
				"          resolvebykpiid as string,",
				"          resolvebykpiid_entitytype as string,",
				"          responsiblecontactid as string,",
				"          responsiblecontactid_entitytype as string,",
				"          slaid as string,",
				"          slaid_entitytype as string,",
				"          slainvokedid as string,",
				"          slainvokedid_entitytype as string,",
				"          socialprofileid as string,",
				"          socialprofileid_entitytype as string,",
				"          subjectid as string,",
				"          subjectid_entitytype as string,",
				"          transactioncurrencyid as string,",
				"          transactioncurrencyid_entitytype as string,",
				"          ownerid as string,",
				"          ownerid_entitytype as string,",
				"          customerid as string,",
				"          customerid_entitytype as string,",
				"          accountidname as string,",
				"          accountidyominame as string,",
				"          actualserviceunits as long,",
				"          billedserviceunits as long,",
				"          caseage as string,",
				"          contactidname as string,",
				"          contactidyominame as string,",
				"          contractdetailidname as string,",
				"          contractidname as string,",
				"          createdbyexternalpartyname as string,",
				"          createdbyexternalpartyyominame as string,",
				"          createdbyname as string,",
				"          createdbyyominame as string,",
				"          createdon as timestamp,",
				"          createdonbehalfbyname as string,",
				"          createdonbehalfbyyominame as string,",
				"          customeridname as string,",
				"          customeridtype as string,",
				"          customeridyominame as string,",
				"          deactivatedon as timestamp,",
				"          description as string,",
				"          emailaddress as string,",
				"          entitlementidname as string,",
				"          entityimage as string,",
				"          entityimage_timestamp as long,",
				"          entityimage_url as string,",
				"          entityimageid as string,",
				"          escalatedon as timestamp,",
				"          exchangerate as decimal(38,12),",
				"          firstresponsebykpiidname as string,",
				"          followupby as timestamp,",
				"          importsequencenumber as long,",
				"          incidentid as string,",
				"          influencescore as double,",
				"          kbarticleidname as string,",
				"          lastinteraction as string,",
				"          lastonholdtime as timestamp,",
				"          masteridname as string,",
				"          modifiedbyexternalpartyname as string,",
				"          modifiedbyexternalpartyyominame as string,",
				"          modifiedbyname as string,",
				"          modifiedbyyominame as string,",
				"          modifiedon as timestamp,",
				"          modifiedonbehalfbyname as string,",
				"          modifiedonbehalfbyyominame as string,",
				"          msdyn_iotalertname as string,",
				"          msdyn_precreateattachmentsid as string,",
				"          msdyn_precreatenotesid as string,",
				"          nextsla as string,",
				"          numberofchildincidents as long,",
				"          onholdtime as long,",
				"          overriddencreatedon as timestamp,",
				"          owneridname as string,",
				"          owneridtype as string,",
				"          owneridyominame as string,",
				"          owningbusinessunitname as string,",
				"          parentcaseidname as string,",
				"          primarycontactidname as string,",
				"          primarycontactidyominame as string,",
				"          processid as string,",
				"          productidname as string,",
				"          productserialnumber as string,",
				"          ract_accountname as string,",
				"          ract_accountyominame as string,",
				"          ract_branch as string,",
				"          ract_caseid as string,",
				"          ract_categoryname as string,",
				"          ract_complaintdesiredoutcomename as string,",
				"          ract_complaintoutcomename as string,",
				"          ract_complaintreopenedreasonname as string,",
				"          ract_complaintsecondaryreasonname as string,",
				"          ract_duedate as timestamp,",
				"          ract_personname as string,",
				"          ract_personyominame as string,",
				"          ract_productname as string,",
				"          ract_representativename as string,",
				"          ract_representativeyominame as string,",
				"          ract_sitename as string,",
				"          ract_sladate as timestamp,",
				"          ract_sourceid as string,",
				"          ract_subcategoryname as string,",
				"          resolveby as timestamp,",
				"          resolvebykpiidname as string,",
				"          responseby as timestamp,",
				"          responsiblecontactidname as string,",
				"          responsiblecontactidyominame as string,",
				"          sentimentvalue as double,",
				"          slainvokedidname as string,",
				"          slaname as string,",
				"          socialprofileidname as string,",
				"          stageid as string,",
				"          subjectidname as string,",
				"          ticketnumber as string,",
				"          timezoneruleversionnumber as long,",
				"          title as string,",
				"          transactioncurrencyidname as string,",
				"          traversedpath as string,",
				"          utcconversiontimezonecode as long,",
				"          versionnumber as long,",
				"          IsDelete as boolean,",
				"          createdonpartition as string,",
				"          PartitionId as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delta',",
				"     fileSystem: 'dataverse-ractproducti-unq03c990a6fb6eee118bc6002248e34',",
				"     folderPath: 'deltalake/incident_partitioned') ~> source1",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false) ~> source2",
				"source1 derive(customerid_new = contactid) ~> derivedColumn1",
				"derivedColumn1, source2 join(customerid == source2@contactid,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          incidentid,",
				"          prioritycode,",
				"          createdon,",
				"          createdby,",
				"          ract_caseid,",
				"          title,",
				"          ticketnumber,",
				"          ract_type,",
				"          subjectid,",
				"          ract_account,",
				"          slaid,",
				"          caseorigincode,",
				"          productid,",
				"          description,",
				"          ract_complaintsecondaryreason,",
				"          ract_complaintdesiredoutcome,",
				"          ract_complaintoutcome,",
				"          ract_isrelatedtoincident,",
				"          ract_haswrittenresponserequested,",
				"          ract_setmanualduedate,",
				"          ract_duedate,",
				"          isescalated,",
				"          escalatedon,",
				"          followupby,",
				"          firstresponsesent,",
				"          ract_site,",
				"          ract_vulnerabilitytypes,",
				"          ract_supportserviceprovided,",
				"          ract_permissionforvulnerabilityrecording,",
				"          ract_representative,",
				"          ract_sourceid,",
				"          ract_complaintreopenedreason,",
				"          ract_sladate,",
				"          contactid,",
				"          customerid",
				"     )) ~> sink1"
			]
		}
	}
}